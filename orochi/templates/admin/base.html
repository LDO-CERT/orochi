{% extends "admin/base.html" %}
{% load i18n static %}

{% block extrastyle %}
<link rel="stylesheet" type="text/css" href="{% static 'css/admin_dropdown.css' %}">
{% endblock %}

{% block header %}
<div id="header">
    <div id="branding" class="navbar-brand">
        {% block branding %}{% endblock %}
    </div>
    {% block usertools %}
    {% if has_permission %}
    <div id="user-tools">
        <ul class="nav_dropdown">
            <li>
                <a href="#">
                    {% translate 'Welcome,' %}
                    <strong>{% firstof user.get_short_name user.get_username %}</strong>
                </a>
                <ul>
                    {% if site_url %}
                    <li>
                        <a href="{{ site_url }}">
                            {% translate 'View site' %}
                        </a>
                    </li>
                    {% endif %}
                    <li>
                        <a href="">{% translate 'Update' %}</a>
                        <ul>
                            <li>
                                <a href="{% url 'api:update_plugins' %}" class="base_admin">
                                    {% translate 'Update Plugins' %}
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'api:update_symbols' %}" class="base_admin">
                                    {% translate 'Update Symbols' %}
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="">{% translate 'Rules' %}</a>
                        <ul>
                            <li>
                                <a href="{% url 'api:update_rules' %}" class="base_admin">
                                    {% translate 'Update Rules' %}
                                </a>
                            </li>
                            <li>
                                <a href="{% url 'api:generate_default_rule' %}" class="base_admin">
                                    {% translate 'Generate Default Rule' %}
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="">{% translate 'Auth' %}</a>
                        <ul>
                            {% if user.has_usable_password %}
                            <li>
                                <a href="{% url 'admin:password_change' %}">
                                    {% translate 'Change password' %}
                                </a>
                            </li>
                            {% endif %}
                            <li>
                                <a href="{% url 'admin:logout' %}">
                                    {% translate 'Log out' %}
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <script src="{% static 'js/jquery-3.5.1.js' %}" type="text/javascript" language="javascript"></script>
    <script>
        $(document).ready(function () {
            // ADMIN COMMAND CRUD RESPONSE
            $(document).on("click", ".base_admin", function (e) {
                e.preventDefault();
                var url = $(this).attr("href");
                $.get(url)
                    .done(function (data) {
                        location.reload();
                    });
            });
        });
    </script>
    {% endif %}
    {% endblock %}
</div>
{% endblock %}
